# RG Family - 기능 갭 분석 (목업 vs 실제 구현)

> **작성일**: 2026-01-16
> **목적**: 회의록 요구사항 대비 현재 구현 상태 분석

---

## 1. 검색·노출 및 기본 구조

### 요구사항
- 네이버·구글 검색 노출을 위해 공식 등록 필요
- 메인 페이지, 타임라인 페이지, 모바일 노출 여부 점검
- 라이브 방송, 유튜브 연동은 링크 업로드 방식으로 관리

### 현재 상태

| 항목 | 상태 | 구현 위치 |
|------|------|-----------|
| 메타 태그 | ✅ 완료 | `src/app/layout.tsx` |
| Open Graph | ✅ 완료 | `src/app/layout.tsx` |
| robots.txt | ⚠️ 파일 존재하나 동적 생성 아님 | `src/app/robots.txt/route.ts` |
| sitemap.xml | ⚠️ 파일 존재하나 동적 생성 아님 | `src/app/sitemap.xml/route.ts` |
| 모바일 반응형 | ✅ 완료 | 각 페이지 CSS module |
| 네이버 웹마스터 등록 | ❌ 미완료 | 수동 등록 필요 |
| 구글 서치콘솔 등록 | ❌ 미완료 | 수동 등록 필요 |
| JSON-LD 구조화 데이터 | ❌ 미구현 | - |

### 필요 작업
1. 네이버 웹마스터도구 사이트 등록
2. 구글 서치콘솔 사이트 등록
3. 동적 sitemap 생성 (페이지 추가 시 자동 반영)

---

## 2. 홈페이지 기능 및 디자인

### 요구사항
- 실제 디자인(이미지·컬러·사진) 적용 필요
- 인원 수에 따라 화면 레이아웃이 유동적으로 변경
- 스크롤 방식, 드래그 UI 등 사용성 개선
- 상단 로고 크기 조정, 배너 사이즈·비율 통일

### 현재 상태

| 항목 | 상태 | 비고 |
|------|------|------|
| 디자인 시스템 | ✅ 완료 | CSS 변수 기반 테마 |
| 다크/라이트 모드 | ✅ 완료 | `ThemeContext` |
| 유동적 레이아웃 | ⚠️ 부분 구현 | 고정 그리드 기반 |
| 배너 관리 | ✅ 완료 | `banners` 테이블 |
| 로고 설정 | ⚠️ 하드코딩 | 동적 변경 불가 |
| 드래그 UI | ❌ 미구현 | - |

### 필요 작업
1. 라이브 멤버 수에 따른 동적 그리드 레이아웃
2. 관리자 페이지에서 로고 이미지 변경 기능
3. 배너 드래그 앤 드롭 정렬 기능

---

## 3. 데이터 관리 (후원·랭킹) ⚠️ 주요 갭

### 요구사항
- 실시간 누적 후원 자동 집계는 어려움
- **엑셀 파일 다운로드 → 관리자 수동 업로드 방식**
- 방송 종료 후 12~24시간 주기 업데이트
- 오류 발생 시 수동 수정 가능

### 현재 상태

| 항목 | 상태 | 구현 위치 |
|------|------|-----------|
| 랭킹 조회 | ✅ 완료 | `useRanking.ts` |
| 시즌별 필터 | ✅ 완료 | `SeasonSelector` |
| 회차별 필터 | ✅ 완료 | `EpisodeSelector` |
| **엑셀 업로드** | ❌ **미구현** | - |
| **엑셀 다운로드** | ❌ **미구현** | - |
| 관리자 수동 수정 | ⚠️ 부분 구현 | donations 직접 편집 불가 |
| 오류 수정 | ❌ 미구현 | - |

### 필요 작업 (우선순위 높음)
```typescript
// 1. 엑셀 업로드 API 필요
POST /api/admin/donations/upload
- 파일 형식: xlsx, csv
- 필드: donor_name, amount, season_id, episode_id

// 2. 엑셀 다운로드 API 필요
GET /api/admin/donations/export?season_id=X&format=xlsx

// 3. 관리자 페이지에 Donations 관리 탭 추가
- /admin/donations 페이지 CRUD 기능
```

---

## 4. VIP 및 랭킹 정책

### 요구사항
- VIP 기준: 시즌별 랭킹(1~50위), 회차별 고액 후원자 포함
- VIP는 자동 박탈보다는 확장 방식
- 시즌별·회차별 기준 명확화
- VIP 개인 페이지, 시즌 기록 표시

### 현재 상태

| 항목 | 상태 | 구현 위치 |
|------|------|-----------|
| Top 50 자동 판정 | ✅ 완료 | `useVipStatus.ts` |
| 시즌별 VIP | ✅ 완료 | donations 집계 |
| 회차별 VIP (직급전) | ✅ 완료 | `useEpisodeRankings.ts` |
| VIP 라운지 페이지 | ✅ 완료 | `/ranking/vip` |
| VIP 개인 페이지 | ✅ 완료 | `/ranking/tribute/[hash]` |
| 시즌 기록 표시 | ⚠️ 부분 구현 | 개인 페이지에 표시 필요 |
| VIP 확장 방식 | ⚠️ 로직 검토 필요 | 박탈 vs 확장 정책 |

### 필요 작업
1. VIP 개인 페이지에 "시즌 1 1위" 같은 기록 배지 표시
2. VIP 확장 정책 구현 (한번 VIP면 유지)
3. 회차별 VIP 기준 명확화 문서화

---

## 5. 계정 및 권한 체계 ⚠️ 주요 갭

### 요구사항
- **관리자**: 전체 관리
- **VIP**: 전용 게시판 및 개인 페이지 접근
- **BJ 관리자**: 방송·콘텐츠 관련 기능만 사용
- **일반 회원**: 자유 게시판만 사용
- **비회원/정회원** 구분 필요

### 현재 상태

| 권한 | 정의 | 구현 상태 |
|------|------|-----------|
| superadmin | ✅ 정의됨 | 전체 관리 |
| admin | ✅ 정의됨 | 전체 관리 |
| moderator | ✅ 정의됨 | 게시판 관리 |
| vip | ✅ 정의됨 | VIP 접근 |
| member | ✅ 정의됨 | 일반 회원 |
| **BJ 관리자** | ❌ **미정의** | - |
| **비회원** | ❌ **미정의** | - |
| **정회원** | ❌ **미정의** | - |

### 현재 권한 체크 함수
```typescript
// src/lib/context/AuthContext.tsx
isAdmin()       // admin 또는 superadmin
isModerator()   // moderator 이상
isVip()         // vip 이상
hasRole(role)   // 특정 role 체크
```

### 필요 작업
```typescript
// 1. Role 타입 확장
type Role =
  | 'guest'        // 비회원
  | 'member'       // 일반 회원 (정회원)
  | 'vip'          // VIP
  | 'bj_manager'   // BJ 관리자 (신규)
  | 'moderator'    // 커뮤니티 관리자
  | 'admin'        // 관리자
  | 'superadmin'   // 최고 관리자

// 2. 권한별 접근 제어
- 비회원: 열람만 가능
- 일반 회원: 자유 게시판 작성
- VIP: VIP 게시판 + 개인 페이지
- BJ 관리자: 방송/콘텐츠/스케줄 관리
- 관리자: 전체 관리
```

---

## 6. 개인 페이지 및 콘텐츠 운영

### 요구사항
- 열혈(후원자) 개인 페이지 운영
- 관리자가 취합해 업로드하는 구조
- 악용 방지: 시즌 미참여·비활동 유저 접근 제한
- VIP/열혈 관리 전용 메뉴 신설

### 현재 상태

| 항목 | 상태 | 구현 위치 |
|------|------|-----------|
| VIP Tribute 페이지 | ✅ 완료 | `/ranking/tribute/[hash]` |
| 방명록 | ✅ 완료 | `tribute_guestbook` 테이블 |
| VIP 이미지 갤러리 | ✅ 완료 | `vip_images` 테이블 |
| 관리자 콘텐츠 업로드 | ⚠️ 부분 구현 | - |
| **접근 제한 (미참여자)** | ❌ **미구현** | - |
| **VIP 관리 전용 메뉴** | ❌ **미구현** | - |

### 필요 작업
1. `/admin/vip-rewards` 페이지 개선
   - 개인 페이지 콘텐츠 관리
   - 메시지/이미지/영상 업로드
2. 시즌 미참여 유저 접근 제한 로직
3. VIP 헌정 페이지 템플릿 관리

---

## 7. 관리자 페이지 현황

### 현재 구현된 관리자 페이지

| 페이지 | 경로 | 상태 |
|--------|------|------|
| 대시보드 | `/admin` | ✅ 완료 |
| 배너 관리 | `/admin/banners` | ✅ 완료 |
| 후원 관리 | `/admin/donations` | ⚠️ 조회만 가능 |
| 미디어 관리 | `/admin/media` | ✅ 완료 |
| 멤버 관리 | `/admin/members` | ✅ 완료 |
| 공지사항 | `/admin/notices` | ✅ 완료 |
| 조직도 | `/admin/organization` | ✅ 완료 |
| 권한 관리 | `/admin/permissions` | ⚠️ 기본 구현 |
| 게시글 관리 | `/admin/posts` | ✅ 완료 |
| 스케줄 | `/admin/schedules` | ✅ 완료 |
| 시즌 관리 | `/admin/seasons` | ✅ 완료 |
| 시그니처 | `/admin/signatures` | ✅ 완료 |
| 타임라인 | `/admin/timeline` | ✅ 완료 |
| VIP 보상 | `/admin/vip-rewards` | ✅ 완료 |

### 누락된 관리 기능
1. **후원 데이터 업로드** (엑셀 import)
2. **후원 데이터 편집** (개별 수정/삭제)
3. **회차 관리** (episodes 테이블)
4. **라이브 상태 수동 설정**

---

## 8. 라이브 방송 시스템

### 요구사항
- 라이브 방송은 링크 업로드 방식으로 관리

### 현재 상태

| 항목 | 상태 | 구현 위치 |
|------|------|-----------|
| PandaTV 크롤링 | ✅ 완료 | `/api/live-status/sync` |
| 라이브 상태 폴링 | ✅ 완료 | `useLiveStatusPolling.ts` |
| 라이브 상태 DB 저장 | ✅ 완료 | `live_status` 테이블 |
| 라이브 페이지 | ✅ 완료 | `/rg/live` |
| **수동 라이브 설정** | ❌ 미구현 | - |
| **유튜브 링크 업로드** | ❌ 미구현 | - |

### 필요 작업
1. 관리자 페이지에서 수동 라이브 ON/OFF
2. 유튜브/외부 링크 등록 기능

---

## 우선순위별 작업 목록

### 🔴 높음 (배포 전 필수)
1. 후원 데이터 엑셀 업로드/다운로드 기능
2. 후원 데이터 관리자 수동 편집 기능
3. 권한 체계 확장 (BJ 관리자, 비회원)
4. 네이버/구글 검색 등록

### 🟡 중간 (초기 운영 필요)
5. VIP 개인 페이지 시즌 기록 표시
6. 회차(episodes) 관리 페이지
7. 라이브 상태 수동 설정
8. SEO 최적화 (JSON-LD)

### 🟢 낮음 (추후 개선)
9. 드래그 앤 드롭 UI
10. 동적 레이아웃 (라이브 인원수 반영)
11. 게시판 신고 기능
12. 권한 감시 로그

---

## 데이터 흐름 요약

```
┌─────────────────────────────────────────────────────────────┐
│                    현재 데이터 흐름                           │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  [PandaTV] ──크롤링──> [/api/live-status] ──> [Supabase]    │
│                                                              │
│  [관리자] ──수동입력──> [Admin Pages] ──> [Supabase]         │
│                                                              │
│  [Mock Data] ─────────> [USE_MOCK_DATA=true] ──> [Frontend]  │
│                                                              │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                    필요한 데이터 흐름                         │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  [엑셀 파일] ──업로드──> [/api/admin/donations/upload]       │
│                    ↓                                         │
│              [파싱/검증]                                      │
│                    ↓                                         │
│              [Supabase donations 테이블]                     │
│                    ↓                                         │
│              [랭킹 자동 계산]                                 │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 결론

### 잘 구현된 부분
- Repository Pattern 기반 Clean Architecture
- Mock/Supabase 전환 구조
- VIP 시스템 (Top 50, 직급전 기반)
- 게시판/댓글/좋아요 시스템
- 라이브 상태 폴링

### 주요 갭
1. **후원 데이터 관리** - 엑셀 업로드/다운로드 없음
2. **권한 세분화** - BJ 관리자 역할 없음
3. **검색 노출** - 네이버/구글 미등록
4. **콘텐츠 관리** - VIP 개인 페이지 관리 불편

### 추천 작업 순서
1. 후원 데이터 엑셀 업로드 API 구현
2. 관리자 페이지 후원 데이터 편집 기능
3. 검색엔진 등록 (네이버/구글)
4. 권한 체계 확장
